{"ast":null,"code":"import axios from 'axios';\nimport config from '../config';\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';\nconst api = axios.create({\n  baseURL: config.API_URL,\n  // Use config\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request interceptor\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor\napi.interceptors.response.use(response => response, error => {\n  var _error$response;\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    localStorage.removeItem('token');\n    window.location.href = '/';\n  }\n  return Promise.reject(error);\n});\n\n// Auth\nexport const login = (username, password) => api.post('/api/auth/login', new URLSearchParams({\n  username,\n  password\n}));\nexport const register = (username, email, password, fullName) => api.post('/api/auth/register', {\n  username,\n  email,\n  password,\n  full_name: fullName\n});\n\n// Users\nexport const getCurrentUser = () => api.get('/api/users/me');\nexport const getAllUsers = () => api.get('/api/users');\n\n// Rooms\nexport const getRooms = () => api.get('/api/rooms');\nexport const getRoom = roomId => api.get(`/api/rooms/${roomId}`);\nexport const createRoom = roomData => api.post('/api/rooms', roomData);\nexport const joinRoom = roomId => api.post(`/api/rooms/${roomId}/join`);\n\n// NEW: Room Invites\nexport const inviteToRoom = (roomId, userId) => api.post(`/api/rooms/${roomId}/invite`, {\n  user_id: userId\n});\nexport const getMyInvites = () => api.get('/api/rooms/invites');\nexport const acceptInvite = inviteId => api.post(`/api/rooms/invites/${inviteId}/accept`);\nexport const declineInvite = inviteId => api.post(`/api/rooms/invites/${inviteId}/decline`);\n\n// Messages\nexport const getRoomMessages = roomId => api.get(`/api/rooms/${roomId}/messages`);\nexport const createMessage = messageData => api.post('/api/messages', messageData);\nexport const deleteMessage = messageId => api.delete(`/api/messages/${messageId}`);\n\n// NEW: File Upload\nexport const uploadFile = async (file, roomId) => {\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('room_id', roomId);\n  return api.post('/api/messages/upload', formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  });\n};\n\n// Reactions\nexport const addReaction = (messageId, emoji) => api.post(`/api/messages/${messageId}/reactions`, {\n  emoji\n});\nexport default api;\n\n// Add response interceptor with better error logging\napi.interceptors.response.use(response => {\n  console.log('API Response:', response.config.url, response.status);\n  return response;\n}, error => {\n  var _error$config, _error$response2, _error$response3, _error$response3$data, _error$response4;\n  console.error('API Error:', {\n    url: (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url,\n    status: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status,\n    message: ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.detail) || error.message\n  });\n  if (((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.status) === 401) {\n    localStorage.removeItem('token');\n    window.location.href = '/';\n  }\n  return Promise.reject(error);\n});","map":{"version":3,"names":["axios","config","API_URL","process","env","REACT_APP_API_URL","api","create","baseURL","headers","interceptors","request","use","token","localStorage","getItem","Authorization","error","Promise","reject","response","_error$response","status","removeItem","window","location","href","login","username","password","post","URLSearchParams","register","email","fullName","full_name","getCurrentUser","get","getAllUsers","getRooms","getRoom","roomId","createRoom","roomData","joinRoom","inviteToRoom","userId","user_id","getMyInvites","acceptInvite","inviteId","declineInvite","getRoomMessages","createMessage","messageData","deleteMessage","messageId","delete","uploadFile","file","formData","FormData","append","addReaction","emoji","console","log","url","_error$config","_error$response2","_error$response3","_error$response3$data","_error$response4","message","data","detail"],"sources":["E:/Charla_V03/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\nimport config from '../config';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';\r\n\r\n\r\n\r\nconst api = axios.create({\r\n  baseURL: config.API_URL, // Use config\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Request interceptor\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor\r\napi.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response?.status === 401) {\r\n      localStorage.removeItem('token');\r\n      window.location.href = '/';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Auth\r\nexport const login = (username, password) =>\r\n  api.post('/api/auth/login', new URLSearchParams({ username, password }));\r\n\r\nexport const register = (username, email, password, fullName) =>\r\n  api.post('/api/auth/register', { username, email, password, full_name: fullName });\r\n\r\n// Users\r\nexport const getCurrentUser = () => api.get('/api/users/me');\r\nexport const getAllUsers = () => api.get('/api/users');\r\n\r\n// Rooms\r\nexport const getRooms = () => api.get('/api/rooms');\r\nexport const getRoom = (roomId) => api.get(`/api/rooms/${roomId}`);\r\nexport const createRoom = (roomData) => api.post('/api/rooms', roomData);\r\nexport const joinRoom = (roomId) => api.post(`/api/rooms/${roomId}/join`);\r\n\r\n// NEW: Room Invites\r\nexport const inviteToRoom = (roomId, userId) => \r\n  api.post(`/api/rooms/${roomId}/invite`, { user_id: userId });\r\n\r\nexport const getMyInvites = () => api.get('/api/rooms/invites');\r\n\r\nexport const acceptInvite = (inviteId) => \r\n  api.post(`/api/rooms/invites/${inviteId}/accept`);\r\n\r\nexport const declineInvite = (inviteId) => \r\n  api.post(`/api/rooms/invites/${inviteId}/decline`);\r\n\r\n// Messages\r\nexport const getRoomMessages = (roomId) =>\r\n  api.get(`/api/rooms/${roomId}/messages`);\r\n\r\nexport const createMessage = (messageData) =>\r\n  api.post('/api/messages', messageData);\r\n\r\nexport const deleteMessage = (messageId) =>\r\n  api.delete(`/api/messages/${messageId}`);\r\n\r\n// NEW: File Upload\r\nexport const uploadFile = async (file, roomId) => {\r\n  const formData = new FormData();\r\n  formData.append('file', file);\r\n  formData.append('room_id', roomId);\r\n  \r\n  return api.post('/api/messages/upload', formData, {\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data',\r\n    },\r\n  });\r\n};\r\n\r\n// Reactions\r\nexport const addReaction = (messageId, emoji) =>\r\n  api.post(`/api/messages/${messageId}/reactions`, { emoji });\r\n\r\nexport default api;\r\n\r\n// Add response interceptor with better error logging\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    console.log('API Response:', response.config.url, response.status);\r\n    return response;\r\n  },\r\n  (error) => {\r\n    console.error('API Error:', {\r\n      url: error.config?.url,\r\n      status: error.response?.status,\r\n      message: error.response?.data?.detail || error.message\r\n    });\r\n    \r\n    if (error.response?.status === 401) {\r\n      localStorage.removeItem('token');\r\n      window.location.href = '/';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}