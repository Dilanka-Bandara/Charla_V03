{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{motion}from'framer-motion';import{FiSend,FiSmile,FiPaperclip}from'react-icons/fi';import EmojiPicker from'emoji-picker-react';import{createMessage}from'../../services/api';import{useWebSocket}from'../../hooks/useWebSocket';import toast from'react-hot-toast';import'./MessageInput.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessageInput=_ref=>{let{roomId}=_ref;const[message,setMessage]=useState('');const[showEmojiPicker,setShowEmojiPicker]=useState(false);const[isTyping,setIsTyping]=useState(false);const inputRef=useRef(null);const typingTimeoutRef=useRef(null);const{sendTyping}=useWebSocket();useEffect(()=>{return()=>{if(typingTimeoutRef.current){clearTimeout(typingTimeoutRef.current);}};},[]);const handleInputChange=e=>{const value=e.target.value;setMessage(value);if(value&&!isTyping){setIsTyping(true);sendTyping(roomId,true);}if(typingTimeoutRef.current){clearTimeout(typingTimeoutRef.current);}typingTimeoutRef.current=setTimeout(()=>{setIsTyping(false);sendTyping(roomId,false);},1000);};const handleSubmit=async e=>{e.preventDefault();if(!message.trim())return;try{var _inputRef$current;await createMessage({content:message.trim(),room_id:roomId,message_type:'text'});setIsTyping(false);sendTyping(roomId,false);setMessage('');setShowEmojiPicker(false);(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0?void 0:_inputRef$current.focus();}catch(error){toast.error('Failed to send message');console.error('Failed to send message:',error);}};const handleEmojiClick=emojiData=>{var _inputRef$current2;setMessage(prev=>prev+emojiData.emoji);(_inputRef$current2=inputRef.current)===null||_inputRef$current2===void 0?void 0:_inputRef$current2.focus();};const handleKeyPress=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit(e);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"message-input-container\",children:[showEmojiPicker&&/*#__PURE__*/_jsx(\"div\",{className:\"emoji-picker-wrapper\",children:/*#__PURE__*/_jsx(EmojiPicker,{onEmojiClick:handleEmojiClick,theme:\"dark\",width:\"100%\",height:\"350px\"})}),/*#__PURE__*/_jsxs(\"form\",{className:\"message-input glass-card\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"input-action-btn\",onClick:()=>setShowEmojiPicker(!showEmojiPicker),children:/*#__PURE__*/_jsx(FiSmile,{size:22})}),/*#__PURE__*/_jsx(\"textarea\",{ref:inputRef,value:message,onChange:handleInputChange,onKeyPress:handleKeyPress,placeholder:\"Type a message...\",rows:\"1\",className:\"message-textarea\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"input-action-btn\",title:\"Attach file (Coming soon)\",children:/*#__PURE__*/_jsx(FiPaperclip,{size:22})}),/*#__PURE__*/_jsx(motion.button,{type:\"submit\",className:\"send-btn\",disabled:!message.trim(),whileHover:{scale:message.trim()?1.05:1},whileTap:{scale:message.trim()?0.95:1},children:/*#__PURE__*/_jsx(FiSend,{size:20})})]})]});};export default MessageInput;","map":{"version":3,"names":["React","useState","useRef","useEffect","motion","FiSend","FiSmile","FiPaperclip","EmojiPicker","createMessage","useWebSocket","toast","jsx","_jsx","jsxs","_jsxs","MessageInput","_ref","roomId","message","setMessage","showEmojiPicker","setShowEmojiPicker","isTyping","setIsTyping","inputRef","typingTimeoutRef","sendTyping","current","clearTimeout","handleInputChange","e","value","target","setTimeout","handleSubmit","preventDefault","trim","_inputRef$current","content","room_id","message_type","focus","error","console","handleEmojiClick","emojiData","_inputRef$current2","prev","emoji","handleKeyPress","key","shiftKey","className","children","onEmojiClick","theme","width","height","onSubmit","type","onClick","size","ref","onChange","onKeyPress","placeholder","rows","title","button","disabled","whileHover","scale","whileTap"],"sources":["E:/Charla_V03/frontend/src/components/Chat/MessageInput.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { FiSend, FiSmile, FiPaperclip } from 'react-icons/fi';\r\nimport EmojiPicker from 'emoji-picker-react';\r\nimport { createMessage } from '../../services/api';\r\nimport { useWebSocket } from '../../hooks/useWebSocket';\r\nimport toast from 'react-hot-toast';\r\nimport './MessageInput.css';\r\n\r\nconst MessageInput = ({ roomId }) => {\r\n  const [message, setMessage] = useState('');\r\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const inputRef = useRef(null);\r\n  const typingTimeoutRef = useRef(null);\r\n  const { sendTyping } = useWebSocket();\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const handleInputChange = (e) => {\r\n    const value = e.target.value;\r\n    setMessage(value);\r\n\r\n    if (value && !isTyping) {\r\n      setIsTyping(true);\r\n      sendTyping(roomId, true);\r\n    }\r\n\r\n    if (typingTimeoutRef.current) {\r\n      clearTimeout(typingTimeoutRef.current);\r\n    }\r\n\r\n    typingTimeoutRef.current = setTimeout(() => {\r\n      setIsTyping(false);\r\n      sendTyping(roomId, false);\r\n    }, 1000);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!message.trim()) return;\r\n\r\n    try {\r\n      await createMessage({\r\n        content: message.trim(),\r\n        room_id: roomId,\r\n        message_type: 'text'\r\n      });\r\n\r\n      setIsTyping(false);\r\n      sendTyping(roomId, false);\r\n      \r\n      setMessage('');\r\n      setShowEmojiPicker(false);\r\n      inputRef.current?.focus();\r\n    } catch (error) {\r\n      toast.error('Failed to send message');\r\n      console.error('Failed to send message:', error);\r\n    }\r\n  };\r\n\r\n  const handleEmojiClick = (emojiData) => {\r\n    setMessage(prev => prev + emojiData.emoji);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit(e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"message-input-container\">\r\n      {showEmojiPicker && (\r\n        <div className=\"emoji-picker-wrapper\">\r\n          <EmojiPicker\r\n            onEmojiClick={handleEmojiClick}\r\n            theme=\"dark\"\r\n            width=\"100%\"\r\n            height=\"350px\"\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      <form className=\"message-input glass-card\" onSubmit={handleSubmit}>\r\n        <button\r\n          type=\"button\"\r\n          className=\"input-action-btn\"\r\n          onClick={() => setShowEmojiPicker(!showEmojiPicker)}\r\n        >\r\n          <FiSmile size={22} />\r\n        </button>\r\n\r\n        <textarea\r\n          ref={inputRef}\r\n          value={message}\r\n          onChange={handleInputChange}\r\n          onKeyPress={handleKeyPress}\r\n          placeholder=\"Type a message...\"\r\n          rows=\"1\"\r\n          className=\"message-textarea\"\r\n        />\r\n\r\n        <button\r\n          type=\"button\"\r\n          className=\"input-action-btn\"\r\n          title=\"Attach file (Coming soon)\"\r\n        >\r\n          <FiPaperclip size={22} />\r\n        </button>\r\n\r\n        <motion.button\r\n          type=\"submit\"\r\n          className=\"send-btn\"\r\n          disabled={!message.trim()}\r\n          whileHover={{ scale: message.trim() ? 1.05 : 1 }}\r\n          whileTap={{ scale: message.trim() ? 0.95 : 1 }}\r\n        >\r\n          <FiSend size={20} />\r\n        </motion.button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessageInput;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}